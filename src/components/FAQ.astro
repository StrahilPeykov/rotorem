---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const isEN = lang === 'en';

// FAQ questions and answers
const faqs = [
  {
    question: isEN ? 'How much does the diagnostic service cost?' : 'Колко струва диагностиката?',
    answer: isEN 
      ? 'Our diagnostic fee is 30 BGN (15,32 €), which covers the home visit, inspection, and diagnosis of your appliance issue. This fee is applied regardless of whether you proceed with the repair.'
      : 'Нашата такса за диагностика е 30 лв. (15,32 €), която включва посещението на място, инспекцията и диагностицирането на проблема с вашия уред. Тази такса се прилага независимо дали ще продължите с ремонта.'
  },
  {
    question: isEN ? 'Do you provide same-day repairs?' : 'Предлагате ли ремонт още същия ден?',
    answer: isEN 
      ? 'Yes, in most cases we can complete the repair on the same day as our visit. This depends on the complexity of the issue and whether we have the necessary parts on hand. Our technician will give you a clear timeline after diagnosis.'
      : 'Да, в повечето случаи можем да завършим ремонта още същия ден като нашето посещение. Това зависи от сложността на проблема и дали разполагаме с необходимите части. Нашият техник ще ви даде ясен график след диагностиката.'
  },
  {
    question: isEN ? 'What areas do you service?' : 'Кои райони обслужвате?',
    answer: isEN 
      ? 'We service Varna city and surrounding areas within a 20km radius, including all neighborhoods and nearby villages and towns.'
      : 'Обслужваме град Варна и околностите в радиус от 20 км, включително всички квартали и близките села и градове.'
  },
  {
    question: isEN ? 'What appliances do you repair?' : 'Какви уреди ремонтирате?',
    answer: isEN 
      ? 'We repair washing machines, dishwashers, ovens, dryers, and electrical systems. Contact us for details about your specific appliance needs.'
      : 'Ремонтираме перални, съдомиялни, фурни, сушилни и електрически системи. Свържете се с нас за подробности относно вашия конкретен уред.'
  },
  {
    question: isEN ? 'Do you provide warranty on repairs?' : 'Предоставяте ли гаранция за ремонтите?',
    answer: isEN 
      ? 'Yes, we provide warranty on our repairs. The specific warranty period depends on the type of repair and will be discussed during your service.'
      : 'Да, предоставяме гаранция за нашите ремонти. Конкретният гаранционен период зависи от вида на ремонта и ще бъде обсъден по време на вашето обслужване.'
  },
];

const sectionTitle = isEN ? 'Frequently Asked Questions' : 'Често задавани въпроси';
const contactText = isEN 
  ? 'Have more questions? Contact us directly:'
  : 'Имате още въпроси? Свържете се директно с нас:';
---

<section id="faq" class="py-16 md:py-20 bg-white border-t border-gray-100">
  <div class="container">
    <div class="text-center max-w-3xl mx-auto mb-10 md:mb-12">
      <h2 class="text-3xl font-bold text-gray-900">{sectionTitle}</h2>
      <div class="w-20 h-1 bg-accent mx-auto my-4"></div>
    </div>
    
    <div class="max-w-3xl mx-auto">
      <!-- FAQ accordions with mobile styling -->
      <div class="space-y-4">
        {faqs.map((faq, index) => (
          <div class="bg-gradient-to-r from-gray-50 to-white rounded-lg border border-gray-200 overflow-hidden shadow-sm hover:shadow-md transition-all duration-300">
            <details class="group">
              <summary class="flex justify-between items-center p-5 cursor-pointer">
                <h3 class="text-lg font-semibold text-gray-900">{faq.question}</h3>
                <!-- Animated chevron icon -->
                <div class="flex-shrink-0 ml-2 text-gray-500 transition-transform duration-300 group-open:rotate-180">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </div>
              </summary>
              <!-- Answer with subtle animation and better padding -->
              <div class="p-5 pt-0 text-gray-700 border-t border-gray-100 animate-fadeIn">
                <p>{faq.answer}</p>
              </div>
            </details>
          </div>
        ))}
      </div>
      
      <!-- Contact section with improved mobile layout - PHONE ONLY NOW -->
      <div class="mt-12 text-center">
        <p class="text-gray-700 mb-6">{contactText}</p>
        <!-- Mobile-first responsive button layout - PHONE AND EMAIL ONLY -->
        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <a href="tel:+359 89 834 0982" class="btn-primary inline-flex items-center justify-center shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
            +359 89 834 0982
          </a>
          <a href="mailto:n.ivanov.ivanov@abv.bg" class="btn-primary inline-flex items-center justify-center shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            n.ivanov.ivanov@abv.bg
          </a>
        </div>
        
        <!-- Additional info text for phone booking -->
        <div class="mt-4 text-center text-gray-600 text-sm">
          <p>{isEN ? 'Call to schedule your repair appointment' : 'Обадете се за запазване на час за ремонт'}</p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Animation for dropdown */
  details summary::-webkit-details-marker {
    display: none;
  }
  
  /* Subtle animation for opening accordions */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out;
  }
</style>

<script>
  // Toggle for FAQs
  document.addEventListener('DOMContentLoaded', () => {
    const detailsElements = document.querySelectorAll('details');
    
    detailsElements.forEach(details => {
      const summary = details.querySelector('summary');
      
      // Only attach the listener to the summary element
      if (summary) {
        summary.addEventListener('click', (e) => {
          // Don't prevent default behavior - let it toggle naturally
          // Just close other details when opening a new one
          if (!details.open) {
            detailsElements.forEach(el => {
              if (el !== details) el.removeAttribute('open');
            });
          }
        });
      }
    });
  });
</script>
