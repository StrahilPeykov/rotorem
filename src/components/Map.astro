---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const isEN = lang === 'en';

const title = isEN ? 'Our Service Area' : 'Нашият район на обслужване';
const subtitle = isEN
  ? 'Mobile appliance repair teams covering Varna & Sofia with fast response in each city and nearby towns (≈20km radius).'
  : 'Мобилни сервизни екипи, които обслужват Варна и София с бърза реакция в града и околните населени места (≈20 км радиус).';
const areaLabel = isEN ? 'Neighbourhoods we cover:' : 'Квартали, които обслужваме:';
const contactLabel = isEN ? 'Need help for another location?' : 'Нуждаете се от ремонт на друго място?';
const contactText = isEN
  ? 'Call us to confirm availability outside the core zones or to schedule the nearest technician.'
  : 'Обадете се, за да потвърдим посещение извън основните квартали или за график на най-близкия техник.';

const serviceAreas = [
  {
    key: 'varna',
    heading: isEN ? 'Varna & Black Sea Coast' : 'Варна и Черноморието',
    description: isEN
      ? 'Experienced technicians based in Varna cover seaside neighbourhoods and nearby resorts, including villages within roughly 20 km.'
      : 'Опитни техници във Варна покриват крайморските квартали и близките курорти, както и селата в радиус около 20 км.',
    mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d93863.19553341077!2d27.837949771951357!3d43.21719036667841!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40a4538baaf3d7a1%3A0x5727941c71a58b7c!2sVarna%2C%20Bulgaria!5e0!3m2!1sen!2sus!4v1715959693332!5m2!1sen!2sus',
    areas: isEN
      ? ['City Center', 'Chayka', 'Levski', 'Mladost', 'Asparuhovo', 'Galata', 'Golden Sands', 'Saints Constantine & Helena']
      : ['Център', 'Чайка', 'Левски', 'Младост', 'Аспарухово', 'Галата', 'Златни пясъци', 'Св. Константин и Елена'],
  },
  {
    key: 'sofia',
    heading: isEN ? 'Sofia & Capital Districts' : 'София и столичните квартали',
    description: isEN
      ? 'Our Sofia crew handles downtown appointments and rapid response across the capital’s growing residential areas.'
      : 'Екипът в София поема адреси в центъра и осигурява бърза реакция във всички развиващи се столични квартали.',
    mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d94491.42422324641!2d23.2370273!3d42.6953464!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40aa857464314fbf%3A0x400a01269bf6930!2sSofia%2C%20Bulgaria!5e0!3m2!1sen!2sbg!4v1715959693332!5m2!1sen!2sbg',
    areas: isEN
      ? ['City Center', 'Lozenets', 'Mladost', 'Lyulin', 'Studentski Grad', 'Vitosha', 'Ovcha Kupel', 'Manastirski Livadi']
      : ['Център', 'Лозенец', 'Младост', 'Люлин', 'Студентски град', 'Витоша', 'Овча купел', 'Манастирски ливади'],
  },
];
---

<section id="service-area" class="py-16 bg-gradient-to-b from-white to-gray-50 border-t border-gray-100">
  <div class="container">
    <div class="text-center mb-10">
      <h2 class="text-2xl md:text-3xl font-bold text-gray-900">{title}</h2>
      <div class="w-16 h-1 bg-accent mx-auto my-4"></div>
      <p class="mt-2 text-gray-700 max-w-3xl mx-auto">{subtitle}</p>
    </div>

    <div class="grid gap-8 md:grid-cols-2">
      {serviceAreas.map((area) => (
        <div class="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden hover:shadow-lg transition-shadow" data-city={area.key}>
          <div class="relative h-56 md:h-64 w-full">
            <iframe 
              src={area.mapEmbed}
              width="600"
              height="450"
              style="border:0;"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              class="absolute inset-0 w-full h-full"
            ></iframe>
          </div>
          <div class="p-6 flex flex-col gap-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-900 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
                {area.heading}
              </h3>
              <p class="mt-2 text-gray-600 leading-relaxed">{area.description}</p>
            </div>
            <div>
              <p class="text-xs uppercase tracking-wide text-gray-500 font-semibold">{areaLabel}</p>
              <div class="mt-3 flex flex-wrap gap-2">
                {area.areas.map((neighborhood) => (
                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800 border border-blue-200 shadow-sm">
                    {neighborhood}
                  </span>
                ))}
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>

    <div class="mt-10 grid gap-6 md:grid-cols-2">
      <div class="bg-gradient-to-r from-primary-dark/5 to-primary/10 rounded-xl p-6 border border-primary/10 shadow-md">
        <h3 class="font-semibold text-lg text-gray-900 mb-3 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
          </svg>
          {contactLabel}
        </h3>
        <p class="text-gray-700 mb-5 leading-relaxed">{contactText}</p>
        <div class="flex flex-col gap-3">
          <a href="tel:+359 89 834 0982" class="btn-primary inline-flex items-center justify-center w-full shadow-md hover:scale-105 transition-transform duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
            +359 89 834 0982
          </a>
          <a href="mailto:n.ivanov.ivanov@abv.bg" class="btn-cta inline-flex items-center justify-center w-full shadow-md hover:scale-105 transition-transform duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            {isEN ? 'Send Email' : 'Изпратете имейл'}
          </a>
        </div>
        <div class="mt-3 text-center text-gray-600 text-sm">
          <p>{isEN ? 'Call to schedule your repair appointment' : 'Обадете се за запазване на час за ремонт'}</p>
        </div>
      </div>

      <div class="bg-gradient-to-r from-white to-blue-50 rounded-xl p-6 shadow-md border border-gray-100">
        <h3 class="font-semibold text-lg text-gray-900 mb-4 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          {isEN ? 'Working Hours' : 'Работно време'}
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between items-center bg-white/50 p-2 rounded-lg">
            <span class="text-gray-700 font-medium">{isEN ? 'Monday - Friday' : 'Понеделник - Петък'}</span>
            <span class="font-semibold text-gray-900 bg-white py-1 px-3 rounded-full shadow-sm border border-gray-100">08:00 - 18:00</span>
          </div>
          <div class="flex justify-between items-center bg-white/50 p-2 rounded-lg">
            <span class="text-gray-700 font-medium">{isEN ? 'Saturday' : 'Събота'}</span>
            <span class="font-semibold text-gray-900 bg-white py-1 px-3 rounded-full shadow-sm border border-gray-100">
              {t('contact.closed')}
            </span>
          </div>
          <div class="flex justify-between items-center bg-white/50 p-2 rounded-lg">
            <span class="text-gray-700 font-medium">{isEN ? 'Sunday' : 'Неделя'}</span>
            <span class="font-semibold text-gray-900 bg-white py-1 px-3 rounded-full shadow-sm border border-gray-100">
              {t('contact.closed')}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
